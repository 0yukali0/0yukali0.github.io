"use strict";(self.webpackChunk_0yukali0=self.webpackChunk_0yukali0||[]).push([[395],{3905:(e,t,a)=>{a.d(t,{Zo:()=>i,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},i=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),u=c(a),h=r,k=u["".concat(l,".").concat(h)]||u[h]||m[h]||o;return a?n.createElement(k,s(s({ref:t},i),{},{components:a})):n.createElement(k,s({ref:t},i))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=h;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[u]="string"==typeof e?e:r,s[1]=p;for(var c=2;c<o;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},6273:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var n=a(7462),r=(a(7294),a(3905));const o={id:"prometheusStack",title:"Prometheus stack\u5b89\u88dd"},s="prometheus\u8207grafana",p={unversionedId:"kubernetes-native/prometheusStack",id:"kubernetes-native/prometheusStack",title:"Prometheus stack\u5b89\u88dd",description:"\u7372\u53d6prometheus\u8207grafana helm chart",source:"@site/docs/kubernetes-native/promethesuStack.md",sourceDirName:"kubernetes-native",slug:"/kubernetes-native/prometheusStack",permalink:"/docs/kubernetes-native/prometheusStack",draft:!1,editUrl:"https://github.com/0yukali0/0yukali0.github.io/docs/kubernetes-native/promethesuStack.md",tags:[],version:"current",frontMatter:{id:"prometheusStack",title:"Prometheus stack\u5b89\u88dd"},sidebar:"tutorialSidebar",previous:{title:"nginxController\u5b89\u88dd",permalink:"/docs/kubernetes-native/nginxController"},next:{title:"python prometheus ping\u7bc4\u4f8b",permalink:"/docs/kubernetes-native/prometheus/client/python/pythonPingPong"}},l={},c=[{value:"\u7372\u53d6prometheus\u8207grafana helm chart",id:"\u7372\u53d6prometheus\u8207grafana-helm-chart",level:2},{value:"\u900f\u904ehelm\u5b89\u88dd",id:"\u900f\u904ehelm\u5b89\u88dd",level:3},{value:"LoadBalance\u670d\u52d9",id:"loadbalance\u670d\u52d9",level:3},{value:"\u9810\u671f\u756b\u9762",id:"\u9810\u671f\u756b\u9762",level:3},{value:"Ingress(\u53ef\u9078)",id:"ingress\u53ef\u9078",level:2},{value:"\u90e8\u5c6cIngress",id:"\u90e8\u5c6cingress",level:3},{value:"\u66f4\u65b0hosts\u6a94",id:"\u66f4\u65b0hosts\u6a94",level:3},{value:"\u9810\u671f\u756b\u9762",id:"\u9810\u671f\u756b\u9762-1",level:3}],i={toc:c},u="wrapper";function m(e){let{components:t,...o}=e;return(0,r.kt)(u,(0,n.Z)({},i,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"prometheus\u8207grafana"},"prometheus\u8207grafana"),(0,r.kt)("h2",{id:"\u7372\u53d6prometheus\u8207grafana-helm-chart"},"\u7372\u53d6prometheus\u8207grafana helm chart"),(0,r.kt)("p",null,"Promethues\u3001alertmanager\u3001CRD\u8207grafana\u7684helm chart\u8a2d\u5b9a\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update\n")),(0,r.kt)("h3",{id:"\u900f\u904ehelm\u5b89\u88dd"},"\u900f\u904ehelm\u5b89\u88dd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"helm install grafana prometheus-community/kube-prometheus-stack --namespace grafana --create-namespace\n")),(0,r.kt)("h3",{id:"loadbalance\u670d\u52d9"},"LoadBalance\u670d\u52d9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kubectl patch svc grafana -n grafana -p \'{"spec": {"type": "LoadBalancer"}}\'\nkubectl patch svc grafana-kube-prometheus-st-prometheus -n grafana -p \'{"spec": {"type": "LoadBalancer"}}\'\nkubectl patch svc grafana-kube-prometheus-st-alertmanager -n grafana -p \'{"spec": {"type": "LoadBalancer"}}\'\n')),(0,r.kt)("h3",{id:"\u9810\u671f\u756b\u9762"},"\u9810\u671f\u756b\u9762"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Grafana\u7db2\u5740 ",(0,r.kt)("a",{parentName:"li",href:"http://192.168.0.171"},"http://192.168.0.171")),(0,r.kt)("li",{parentName:"ol"},"Prometheus\u7db2\u5740 ",(0,r.kt)("a",{parentName:"li",href:"http://192.168.0.172:9090"},"http://192.168.0.172:9090")),(0,r.kt)("li",{parentName:"ol"},"AlertManager\u7db2\u5740 ",(0,r.kt)("a",{parentName:"li",href:"http://192.168.0.173:9093"},"http://192.168.0.173:9093"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Prometheus stack",src:a(1193).Z,width:"1916",height:"1035"})),(0,r.kt)("h2",{id:"ingress\u53ef\u9078"},"Ingress(\u53ef\u9078)"),(0,r.kt)("h3",{id:"\u90e8\u5c6cingress"},"\u90e8\u5c6cIngress"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: prometheus-stack-ingress\n  namespace: grafana\nspec:\n  ingressClassName: nginx\n  rules:\n  - host: alert.example.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: grafana-kube-prometheus-st-alertmanager\n            port:\n              name: http-web\n  - host: grafana.example.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: grafana\n            port:\n              name: http-web\n  - host: prometheus.example.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: grafana-kube-prometheus-st-prometheus\n            port:\n              name: http-web\n")),(0,r.kt)("h3",{id:"\u66f4\u65b0hosts\u6a94"},"\u66f4\u65b0hosts\u6a94"),(0,r.kt)("p",null,"192.168.0.170\u70baIngress-nginx controller\u7684\u5916\u90e8IP"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"192.168.0.170 grafana.example.com\n192.168.0.170 prometheus.example.com\n192.168.0.170 alert.example.com\n")),(0,r.kt)("h3",{id:"\u9810\u671f\u756b\u9762-1"},"\u9810\u671f\u756b\u9762"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Prometheus stack",src:a(2132).Z,width:"1915",height:"1025"})))}m.isMDXComponent=!0},1193:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/loadBlanacerGrafanaAndPrometheus-a15e843f20a5de0e47c414e8eef18865.png"},2132:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/prometheusIngress-335eac63d6af281f635132835fc751cd.png"}}]);