"use strict";(self.webpackChunk_0_yukali_0_github_io=self.webpackChunk_0_yukali_0_github_io||[]).push([[3749],{65:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var t=n(4848),s=n(8453);const r={id:"rrd",title:"spark-RRD"},i="Resilient Distributed Datasets (RRDs)",l={id:"hadoop-native/spark/base/rrd",title:"spark-RRD",description:"\x3c!--",source:"@site/docs/hadoop-native/spark/base/rrd.md",sourceDirName:"hadoop-native/spark/base",slug:"/hadoop-native/spark/base/rrd",permalink:"/docs/hadoop-native/spark/base/rrd",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/hadoop-native/spark/base/rrd.md",tags:[],version:"current",frontMatter:{id:"rrd",title:"spark-RRD"}},o={},d=[{value:"\u5982\u4f55\u5f15\u7528",id:"\u5982\u4f55\u5f15\u7528",level:2},{value:"Parallelized Collections",id:"parallelized-collections",level:3},{value:"External Datasets",id:"external-datasets",level:3},{value:"RDD \u64cd\u4f5c",id:"rdd-\u64cd\u4f5c",level:2},{value:"\u81ea\u8a02\u8cc7\u6599\u8655\u7406\u51fd\u6578\u65bcspark",id:"\u81ea\u8a02\u8cc7\u6599\u8655\u7406\u51fd\u6578\u65bcspark",level:3}];function c(e){const a={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.header,{children:(0,t.jsx)(a.h1,{id:"resilient-distributed-datasets-rrds",children:"Resilient Distributed Datasets (RRDs)"})}),"\n",(0,t.jsx)(a.h2,{id:"\u5982\u4f55\u5f15\u7528",children:"\u5982\u4f55\u5f15\u7528"}),"\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.em,{children:(0,t.jsx)(a.strong,{children:"SparkConf"})}),"\u70ba\u914d\u7f6e\u6a94\uff0c\u900f\u904esetAppName\u8207setMaster\u4f86\u8a2d\u5b9a\u61c9\u7528\u540d\u7a31\u8207\u90e8\u5c6c\u6a21\u5f0f\u3002\n\u96a8\u5f8c\u5c07SparkConf\u4e1f\u5165",(0,t.jsx)(a.em,{children:(0,t.jsx)(a.strong,{children:"JavaSparkContext"})}),"\u4e2d\uff0c\u5efa\u7acbspark session\u3002"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'import org.apache.spark.SparkConf; \nimport org.apache.spark.api.java.JavaSparkContext;\nimport org.apache.spark.api.java.JavaRDD;\n\nSparkConf conf = new SparkConf().setAppName("My first spark app").setMaster("local");\nJavaSparkContext sc = new JavaSparkContext(conf);\n'})}),"\n",(0,t.jsxs)(a.p,{children:["\u5c07\u8cc7\u6599\u5f15\u5165\u5f8c\u8f49\u5316\u70ba",(0,t.jsx)(a.em,{children:(0,t.jsx)(a.strong,{children:"JavaRDD"})}),"\uff0c\u60c5\u6cc1\u5206\u5225\u70baParallelized Collections\u8207External Datasets\u3002"]}),"\n",(0,t.jsx)(a.h3,{id:"parallelized-collections",children:"Parallelized Collections"}),"\n",(0,t.jsx)(a.p,{children:"Parallelized Collections:\u900f\u904espark\u7684JavaSparkContext(\u4e5f\u5c31\u662fspark session)\uff0c\u5c07Java\u539f\u751f\u8cc7\u6599\u8f49\u5316\u70baJavaRDD\u3002"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"List<Integer> data = Array.asList(1, 2, 3, 4, 5);\nJavaRDD<Integer> distData = sc.paralleize(data);\n"})}),"\n",(0,t.jsx)(a.h3,{id:"external-datasets",children:"External Datasets"}),"\n",(0,t.jsx)(a.p,{children:"External Datasets:\u900f\u904espark\u7684JavaSparkContext(\u4e5f\u5c31\u662fspark session)\u4e4btextFile\u65b9\u6cd5\u8b80\u53d6\u3002\n\u8a72\u65b9\u6cd5\u652f\u63f4\u8207Hadoop\u76f8\u540c\uff0c\u5982local, HDFS(hdfs://your/file/path), HBase, Amazon S3(s3a://your/s3/file/path)\u3002"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'JavaRDD<String> distFile = sc.textFile("data.txt");\n'})}),"\n",(0,t.jsx)(a.h2,{id:"rdd-\u64cd\u4f5c",children:"RDD \u64cd\u4f5c"}),"\n",(0,t.jsx)(a.p,{children:"RRD\u64cd\u4f5c\u5206\u5169\u7a2e\uff0ctransformation\u7522\u751f\u65b0\u7684Dataset\uff0cactions\u5247\u8fd4\u56de\u503c\u3002\ntransformation\u70balazy\uff0c\u4e0d\u6703\u7acb\u5373\u8a08\u7b97\uff0c\u76f4\u5230\u8981\u6c42\u7d50\u679c\u7684\u7576\u4e0b\u3002"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'// 1.Create data myself\nList<Integer> data = Arrays.asList(1, 2, 3, 4, 5);\nJavaRDD<Integer> distData = sc.parallelize(data);\n\n// 2.Read data from file in spark exmaples\nJavaRDD<String> lines = sc.textFile("/opt/spark/examples/src/main/resources/employees.json");\nJavaRDD<Integer> distData = lines.map(s -> s.length());\n\nint total = distData.reduce((a,b) -> a + b);\nSystem.out.println("Sum:" + total);\n'})}),"\n",(0,t.jsx)(a.h3,{id:"\u81ea\u8a02\u8cc7\u6599\u8655\u7406\u51fd\u6578\u65bcspark",children:"\u81ea\u8a02\u8cc7\u6599\u8655\u7406\u51fd\u6578\u65bcspark"}),"\n",(0,t.jsx)(a.p,{children:"Spark\u7684map\u3001reduce\u7b49\u8655\u88e1\u8cc7\u6599\u7684\u6d41\u7a0b\uff0c\u9700\u8981\u4f7f\u7528\u8005\u5b9a\u7fa9\u51fd\u6578\u4ee5\u8655\u88e1\u8cc7\u6599\u3002\n\u4e00\u7a2e\u662f\u5c07\u5b9a\u7fa9\u597d\u7684\u5be6\u4f5corg.apache.spark.api.java.function\u7684class\u50b3\u905e\u7d66spark\u3002"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"class GetLength implements Function<String, Integer> {\n   public Integer call(String s) {return s.length();}\n}\nJavaRDD<Integer> distData = lines.map(new GetLength());\n"})}),"\n",(0,t.jsx)(a.p,{children:"\u4e00\u7a2e\u5247\u7528lambda\u3002"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"JavaRDD<Integer> distData = lines.map(new Function<String, Integer>() {\n    public Integer call(String s) {return s.length();}\n});\n"})})]})}function p(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>i,x:()=>l});var t=n(6540);const s={},r=t.createContext(s);function i(e){const a=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:a},e.children)}}}]);