"use strict";(self.webpackChunk_0_yukali_0_github_io=self.webpackChunk_0_yukali_0_github_io||[]).push([[6873],{7821:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var s=n(4848),r=n(8453);const i={id:"buildkubernetes",title:"kubernetes\u53e2\u96c6\u5efa\u7acb"},o="\u555f\u52d5k8s\u6d41\u7a0b",c={id:"kubernetes-native/base/buildkubernetes",title:"kubernetes\u53e2\u96c6\u5efa\u7acb",description:"\u5b89\u88dd container runtime",source:"@site/docs/kubernetes-native/base/install.md",sourceDirName:"kubernetes-native/base",slug:"/kubernetes-native/base/buildkubernetes",permalink:"/docs/kubernetes-native/base/buildkubernetes",draft:!1,unlisted:!1,editUrl:"https://github.com/0yukali0/0yukali0.github.io/docs/kubernetes-native/base/install.md",tags:[],version:"current",frontMatter:{id:"buildkubernetes",title:"kubernetes\u53e2\u96c6\u5efa\u7acb"}},a={},l=[{value:"\u5b89\u88dd container runtime",id:"\u5b89\u88dd-container-runtime",level:2},{value:"linux kernel\u7db2\u8def\u8a2d\u5b9a",id:"linux-kernel\u7db2\u8def\u8a2d\u5b9a",level:2},{value:"kubeadm\u3001kubectl\u3001kubelet",id:"kubeadmkubectlkubelet",level:2},{value:"K8s\u555f\u52d5",id:"k8s\u555f\u52d5",level:2},{value:"\u9810\u671f\u756b\u9762",id:"\u9810\u671f\u756b\u9762",level:2}];function u(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"\u555f\u52d5k8s\u6d41\u7a0b",children:"\u555f\u52d5k8s\u6d41\u7a0b"})}),"\n",(0,s.jsx)(t.h2,{id:"\u5b89\u88dd-container-runtime",children:"\u5b89\u88dd container runtime"}),"\n",(0,s.jsx)(t.p,{children:"\u63a1\u7528CRI-O\uff0c\u7562\u7adf\u662fk8s\u5b98\u65b9\u5be6\u4f5c\u7684CRI\u5951\u5408runtime"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"wget https://storage.googleapis.com/cri-o/artifacts/cri-o.amd64.v1.29.2.tar.gz\ntar -zxf cri-o.amd64.v1.29.2.tar.gz\n\n# crio \u670d\u52d9\u91cd\u555f\nsudo ./install\nsudo systemctl daemon-reload\nsudo systemctl enable crio --now\n"})}),"\n",(0,s.jsx)(t.h2,{id:"linux-kernel\u7db2\u8def\u8a2d\u5b9a",children:"linux kernel\u7db2\u8def\u8a2d\u5b9a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"cat <<EOF | sudo tee /etc/modules-load.d/k8s.conf\noverlay\nbr_netfilter\nEOF\n\nsudo modprobe overlay\nsudo modprobe br_netfilter\n\n# sysctl params required by setup, params persist across reboots\ncat <<EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.ipv4.ip_forward                 = 1\nEOF\n\n# Apply sysctl params without reboot\nsudo sysctl --system\n"})}),"\n",(0,s.jsx)(t.h2,{id:"kubeadmkubectlkubelet",children:"kubeadm\u3001kubectl\u3001kubelet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"sudo apt-get update\nsudo apt-get install -y apt-transport-https ca-certificates curl gpg\ncurl -fsSL \"https://pkgs.k8s.io/core:/stable:/v1.26/deb/Release.key\" | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg\necho 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.26/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list\nsudo apt-get update\nsudo apt-get install -y kubelet kubeadm kubectl\n"})}),"\n",(0,s.jsx)(t.h2,{id:"k8s\u555f\u52d5",children:"K8s\u555f\u52d5"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"sudo kubeadm init --pod-network-cidr=192.168.0.0/16 --cri-socket=unix:///var/run/crio/crio.sock\nmkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\nkubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.4/manifests/tigera-operator.yaml\nkubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.4/manifests/custom-resources.yaml\nkubectl taint nodes --all node-role.kubernetes.io/control-plane-\nkubectl taint nodes --all node-role.kubernetes.io/master-\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u9810\u671f\u756b\u9762",children:"\u9810\u671f\u756b\u9762"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"K8S\u53e2\u96c6",src:n(2769).A+"",width:"604",height:"308"})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},2769:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/cluster-3e8813efbb5fc09141f9a50e444afe6c.png"},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>c});var s=n(6540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);